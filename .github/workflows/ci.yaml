# CI Workflow for MLOps Project
# This GitHub Actions workflow automates continuous integration (CI) for the project.
# It runs tests whenever code is pushed to the main branch or a pull request is opened against main.

name: CI workflow

# Triggers for the workflow (github actions ne kahiye chie ahiya k..)
# The workflow will run on:
# - Pushes to the main branch
# - Pull requests targeting the main branch
on:
    push:
        branches:
            - main
    pull_request:
        branches:
            - main

# Define the jobs to run
jobs:
    # Job name: test (can be anything)
    # This job runs the test suite on an Ubuntu runner
    test:
        runs-on: ubuntu-latest

        # Steps to execute in the job
        steps:
            # Step 1: Checkout the repository code
            # This action checks out the code from the repository to the runner
            - name: Checkout code
              uses: actions/checkout@v2

            # Step 2: Set up Python environment
            # This action sets up Python 3.9 on the runner
            - name: Set up Python
              uses: actions/setup-python@v2
              with:
                  python-version: '3.9'

            # Step 3: Install project dependencies
            # Upgrade pip and install required packages: pytest for testing, streamlit for the app
            - name: Install dependencies
              run: |
                  python -m pip install --upgrade pip
                  pip install pytest streamlit

            # Step 4: Run the tests
            # Execute pytest on the test file _test.py to run the test suite
            - name: Run tests
              run: |
                  pytest _test.py